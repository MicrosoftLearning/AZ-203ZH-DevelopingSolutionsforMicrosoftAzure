---
lab:
    title: '实验室：使用图像和容器部署计算工作负载'
    type: '答案'
    module: '模块 1：开发 Azure 基础结构即服务 (IaaS) 计算解决方案'
---

# 实验室：使用图像和容器部署计算工作负载
# 学生实验室答案

## Microsoft Azure 用户界面

鉴于 Microsoft 云工具的动态特性，Azure 用户界面 (UI) 在此培训内容开发后可能会发生更改。这些更改可能会导致实验室说明和实验室步骤不匹配。

一旦 Microsoft 通过社区注意到必要更改，将会立即更新此培训课程。但由于云更新频繁，你可能会在此培训内容更新前遇到 UI 更改。**如果发生这种情况，请根据需要适更改并在实验室中完成这些更改。**

## 说明

### 开始前

#### 登录实验室虚拟机

使用以下凭据登录到 **Windows 10** 虚拟机：
    
-   **用户名**： Admin

-   **密码**：Pa55w.rd

> **注**： 讲师将为你提供实验室虚拟机登录说明。

#### 查看已安装的应用

观察位于 **Windows 10** 桌面底部的任务栏。任务栏包含将在本实验室中使用的应用程序图标：
    
-   Microsoft Edge

-   文件资源管理器

### 练习 1：使用 Azure 门户创建虚拟机 (VM)

#### 任务 1：打开 Azure 门户

1.  在任务栏上，选择 **Microsoft Edge** 图标。

1.  在打开的浏览器窗口中，导航到 **Azure 门户** ([portal.azure.com](https://portal.azure.com))。

1.  输入 Microsoft 帐户的 **电子邮件地址**。

1.  选择 **下一步**。

1.  输入 Microsoft 帐户的 **密码**。

1.  选择 **登录**。

    > **注**： 如果这是你第一次登录 **Azure 门户**，则会出现一个对话框，提供门户教程。选择 **开始使用** 以开始使用门户。

#### 任务 2：创建资源组

1.  在位于门户左侧的导航菜单上，选择 **+ 创建资源** 链接。

    > **注**： 如果你找不到 **创建资源** 链接，“创建资源”图标是位于门户左侧的加号字符。

1.  在顶部的 **新建** 边栏选项卡，找到特色服务列表上方的 **搜索市场** 文本框。

1.  在搜索文本框中，输入文本 **资源组**，然后按 Enter 键。

1.  在 **全部内容** 搜索结果边栏选项卡中，选择 **资源组** 结果。

1.  在 **资源组** 边栏选项卡中，选择 **创建**。

1.  在附加 **资源组** 边栏选项卡中，观察边栏选项卡顶部的选项卡，如 **基本**。

    > **注**： 每个选项卡代表工作流中创建新 **资源组** 的一个步骤。你可以随时选择 **查看 + 创建** 跳过剩余标签。

1.  在 **基本** 选项卡上，执行以下操作：
    
    1.  将 **订阅** 文本框保留设置为默认值。
    
    1.  在 **资源组** 文本框中，输入值 **ContainerCompute**。
    
    1.  在 **区域** 下拉列表中，选择 **（美国）美国东部** 位置。
    
    1.  选择 **查看 +** **创建**。

1.  在 **查看 + 创建** 选项卡中，查看在之前步骤中选择的选项。

1.  选择 **创建** 以使用指定的配置创建资源组。

1. 等待创建任务完成后再继续本实验室。

#### 任务 3：创建 Linux 虚拟机资源

1.  在位于门户左侧的导航菜单上，选择 **+ 创建资源** 链接。

1.  在顶部的 **新建** 边栏选项卡，找到特色服务列表上方的 **搜索市场** 文本框。

1.  在搜索文本框中，输入 **Ubuntu Server 18**，然后按 Enter 键。

1.  在 **全部内容** 搜索结果边栏选项卡中，选择 **Ubuntu Server 18.04 LTS** 结果。

1.  在“**Ubuntu Server 18.04 LTS**”边栏选项卡中，选择“**创建**”。

1.  在 **创建虚拟机** 边栏选项卡中，观察边栏选项卡顶部的选项卡，如 **基本** 和 **磁盘**。

    > **注**：每个选项卡代表工作流中创建新 **虚拟机** 的一个步骤。你可以随时选择 **查看 + 创建** 跳过剩余标签。

1.  在 **基本** 选项卡中，执行以下操作：
    
    1.  将 **订阅** 文本框保留设置为默认值。
    
    1.  在 **资源组** 下拉列表中，选择现有的 **ContainerCompute** 选项。

    1.  在 **虚拟机名称** 文本框中，输入 **simplevm**。
    
    1.  在 **区域** 下拉列表中，选择 **（美国）美国东部** 位置。

    1. 在 **可用性选项** 下拉列表中，确保选中 **无需基础架构冗余**。
    
    1.  在 **映像** 文本框中，确保 **Ubuntu Server 18.04 LTS** 选项已被选中。
    
    1.  在 **大小** 文本框中，选择 **更改大小** 链接。

1.  在 **选择 VM 大小** 边栏选项卡中，执行以下操作：

    1.  从大小列表选择 **B1s** 选项。

    2.  按 **选择**。

1.  回到 **基本** 选项卡并执行以下操作：

    1.  在 **验证类型** 部分，选择 **密码**。

    1.  在 **用户名** 文本框中，输入 **Student**。

    1.  在 **密码** 和 **确认密码** 字段，输入 **StudentPa55w.rd**。

    1.  在 **使用 Azure Active Directory（预览版）登录** 部分，选择 **关**。

    1.  在 **公用入站端口** 部分，选择 **允许选定的端口**。

    1.  在 **选择入站端口** 下拉列表中，仅选择 **SSH (22)**。

    1.  选择 **下一步： Disks \>**。

1. 在 **磁盘** 选项卡中，执行以下操作：

    1.  在 **操作系统磁盘类型** 部分，选择 **标准 SSD**。

    1.  选择 **查看 + 创建**。

1. 在 **查看 + 创建** 选项卡中，查看在之前步骤中选择的选项。

1. 选择 **创建** 以使用指定的配置创建 VM。

1. 等待创建任务完成后再继续本实验室。

#### 任务 4：验证虚拟机

1.  在位于门户左侧的导航菜单上，选择 **资源组** 链接。

1.  在 **资源组** 边栏选项卡中，找到并选择你之前在本实验室中创建的 **ContainerCompute** 资源组。

1.  在 **ContainerCompute** 边栏选项卡中，选择你之前在本实验室中创建的 **simplevm** VM。

1.  在 **虚拟机** 边栏选项卡中，选择 **连接**。

1.  在显示的 **连接到虚拟机** 弹出窗口中，执行以下操作：
    
    1.  在 **IP地址** 文本框中，选择 **公共 IP 地址**。
    
    2.  在 **端口号** 文本框中，输入 **22**。
    
    3.  **复制** **使用VM本地帐户登录** 文本框中的文本。

        >**注**： 你复制的命令将使用 SSH 从远程计算机连接到 VM。你将稍后在实验室中使用此命令。

1.  在门户顶部，选择 **Cloud Shell** 图标打开一个新的 Shell 实例。

    > **注**： **Cloud Shell** 图标使用大于符号和下划线字符表示。

1.  如果这是你第一次使用订阅打开 **Cloud Shell**，将显示 **欢迎使用 Azure Cloud Shell 向导**，帮助你在第一次使用时配置 **Cloud Shell**。在向导中执行以下操作：
    
    1.  将出现一个对话框，提示你创建新的存储帐户以开始使用 Shell。接受默认设置并选择 **创建存储**。
    
    1.  等待 **Cloud Shell** 完成首次设置程序再继续本实验室。

    > **注**： 如果你没有看到 **Cloud Shell** 配置选项，这很可能是因为你在本课程实验室中使用的是现有订阅。实验室是在你使用新订阅的假设下编写的。

1.  在门户底部的 **Cloud Shell** 命令提示符中，**粘贴**你之前在本实验室中复制的命令，然后按 Enter 键以使用 SSH 连接到新 VM。

    > **注**： 此命令取决于你的用户名和 IP 地址。例如，如果用户名是 **Student**，IP 地址是 **40.125.245.5**，则命令未 **ssh Student@40.125.245.5**。

1.  SSH 工具将先通知你无法建立主机的真实性，然后询问是否要继续连接。在提示符中输入 **yes**，然后按 Enter 键以继续连接到 VM。

1. 然后 SSH 工具会要求你输入密码。输入 **StudentPa55w.rd**，然后按 Enter 键以验证 VM。

    > **注**： 输入密码时不显示字符。请注意。

1. 使用 SSH 连接到 VM 后，将在 VM 中看到 Bash Shell 提示符。在提示符中，输入以下命令并按 Enter 键以查看 Linux VM 的计算机名称：

```
uname -mnipo
```

12. 在提示符中，输入以下命令并按 Enter 键以查看有关 Linux VM 分发和操作系统的信息。

```
uname -srv
```

13. 关闭门户底部的 **Cloud Shell** 窗格。

#### 回顾

在本练习中，你使用 Azure 门户界面手动创建了一个新的 VM，并使用 Cloud Shell 和 SSH 连接到该 VM。

### 练习 2：使用 Azure CLI 创建虚拟机 

#### 任务 1：打开 Cloud Shell

1.  在 Azure 门户的顶部导航栏中，选择 **Cloud Shell** 图标打开一个新的 Shell 实例。

1.  等待 **Cloud Shell** 完成连接实例再继续本实验室。

1.  在门户底部的 **Cloud Shell** 命令提示符中，输入以下命令，然后按 Enter 键以查看 Azure CLI 工具的版本：

```
az --version
```

#### 任务 2：使用 Azure CLI 命令

1.  输入以下命令并按 Enter 键以查看 CLI 根级别的子组和命令列表：

```
az --help
```

1.  输入以下命令并按 Enter 键以查看 **虚拟机** 的子组和命令列表：

```
az vm --help
```

1.  输入以下命令并按 Enter 键以查看 **Create Virtual Machine** 命令的参数和示例列表：

```
az vm create --help
```

1.  输入以下命令并按 Enter 键以使用以下设置创建新的 **虚拟机**：
    
      - **资源组**： ContainerCompute
    
      - **名称**： quickvm
    
      - **映像**： Debian
    
      - **用户名**： Student
    
      - **密码**： StudentPa55w.rd

```
az vm create --resource-group ContainerCompute --name quickvm --image Debian --admin-username student --admin-password StudentPa55w.rd
```

> **注**： 如果此命令失败并出现错误，指出找不到 `Resource group “ContainerCompute”`，则可能意味着你在本练实验室开始时，命名资源组时出错，或者你有多个与用户名相关联的订阅。  如果在命名资源组时出错，请在命令中替换将其为正确的名称。  如果你有多个订阅，则可以使用 `az account set --subscription` 命令来选择合适的订阅。

1.  等待 VM 创建过程完成。该过程完成后，命令将返回一个包含计算机相关详细信息的 JSON 文件。

1.  输入以下命令并按 Enter 键以查看包含有关新创建 VM 的各种元数据的更详细 SON 文件：

```
az vm show --resource-group ContainerCompute --name quickvm
```

1.  输入以下命令并按 Enter 键以列出与 VM 关联的所有 IP 地址：

```
az vm list-ip-addresses --resource-group ContainerCompute --name quickvm
```

1.  输入以下命令并按 Enter 键以筛选输出，以便只返回第一个 IP 地址值：

```
az vm list-ip-addresses --resource-group ContainerCompute --name quickvm --query '[].{ip:virtualMachine.network.publicIpAddresses[0].ipAddress}' --output tsv
```

1.  输入以下命令并按 Enter 键以将上一个命令的结果存储在名为 *ipAddress* 的新 Bash Shell 变量中：

```
ipAddress=$(az vm list-ip-addresses --resource-group ContainerCompute --name quickvm --query '[].{ip:virtualMachine.network.publicIpAddresses[0].ipAddress}' --output tsv)
```

1. 输入以下命令并按 Enter 键以打印 Bash Shell 变量 *ipAddress* 的值：

```
echo $ipAddress
```

1. 输入以下命令并按 Enter 键以通过使用 SSH 工具和存储在 Bash Shell 变量 *ipAddress* 中的 IP 地址连接到之前在本实验室中创建的 VM：

```
ssh student@$ipAddress
```

1. **SSH** 工具将先通知你无法建立主机的真实性，然后询问是否要继续连接。输入 **yes**，然后按 Enter 键以继续连接到 VM。

1. 然后 **SSH** 工具会要求你输入密码。输入 **StudentPa55w.rd**，然后按 Enter 键以验证 VM。

1. 使用 SSH 连接到 VM 后，输入以下命令并按 Enter 键以查看描述 Linux VM 的元数据：

```
uname -a
```

1. 关闭门户底部的 **Cloud Shell** 窗格。

#### 回顾

在本练习中，你使用了 Azure Cloud Shell 作为自动脚本的一部分创建 VM。

### 练习 3：创建 Docker 容器映像并部署到 Azure 容器注册表

#### 任务 1：打开 Cloud Shell 和编辑器

1.  在 Azure 门户的顶部导航栏中，选择 **Cloud Shell** 图标打开一个新的 Shell 实例。

1.  等待 **Cloud Shell** 完成连接实例再继续进行本实验室。

1.  在门户底部的 **Cloud Shell** 命令提示符中，输入以下命令并按 **Enter** 键以从根目录移动至 **\~/clouddrive** 目录：

```
cd ~/clouddrive
```

1.  输入以下命令并按 Enter 键以在 **\~/clouddrive** 目录中创建名为 **ipcheck** 的新目录：

```
mkdir ipcheck
```

1.  输入以下命令并按 Enter 键以将活动目录从 **\~/clouddrive** 更改为 **\~/clouddrive/ipcheck**：

```
cd ~/clouddrive/ipcheck
```

1.  输入以下命令并按 Enter 键以在当前目录中创建新的 .NET Core 控制台应用程序：

```
dotnet new console --output .--name ipcheck
```

1.  输入以下命令并按 Enter 键以在名为 **Dockerfile** 的 **\~/clouddrive/ipcheck** 目录中创建一个新文件：

```
touch Dockerfile
```

1.  输入以下命令并按 Enter 键以在当前目录的上下文中打开嵌入式图形编辑器：

```
code .
```

#### 任务 2：创建并测试 .NET Core 应用程序

1.  在图形编辑器中，找到 **文件** 窗格并双击选中 **Program.cs** 文件以在编辑器中打开该文件。

1.  删除 **Program.cs** 文件的全部内容。

1.  将以下代码复制并粘贴到 **Program.cs** 文件中：

```
public class Program
{
    public static void Main(string[] args)
    {        
        if (System.Net.NetworkInformation.NetworkInterface.GetIsNetworkAvailable())
        {
            System.Console.WriteLine("Current IP Addresses:");
            string hostname = System.Net.Dns.GetHostName();
            System.Net.IPHostEntry host = System.Net.Dns.GetHostEntry(hostname);
            foreach(System.Net.IPAddress address in host.AddressList)
            {
                System.Console.WriteLine($"\t{address}");
            }
        }
        else
        {
            System.Console.WriteLine("No Network Connection");
        }
    }
}
```

1.  使用图形编辑器中的菜单或 **Ctrl+S** 键盘快捷键 **保存** **Program.cs** 文件。  不要关闭图形编辑器。

1.  返回命令提示符，输入以下命令并按 Enter 键以执行应用程序：

```
dotnet run
```

1.  观察执行结果。应至少列出 Cloud Shell 实例的一个 IP 地址。

1.  在图形编辑器中，找到编辑器左侧的 **文件** 窗格并双击选中 **Dockerfile** 文件以在编辑器中打开该文件。

8.  将以下代码复制并粘贴到 **Dockerfile** 文件中：

```
FROM mcr.microsoft.com/dotnet/core/sdk:2.2-alpine AS build
WORKDIR /app

COPY *.csproj ./
RUN dotnet restore

COPY ../
RUN dotnet publish --configuration Release --output out

FROM mcr.microsoft.com/dotnet/core/runtime:2.2-alpine
WORKDIR /app

COPY --from=build /app/out .

ENTRYPOINT ["dotnet", "ipcheck.dll"]
```

1.  使用图形编辑器中的菜单或 **Ctrl+S** 键盘快捷键 **保存**  **Dockerfile** 文件。

1. 关闭门户底部的 **Cloud Shell** 窗格。

#### 任务 3：创建 Azure 容器注册表资源

1.  在位于门户左侧的导航菜单上，选择 **+ 创建资源** 链接。

1.  在顶部的 **新建** 边栏选项卡，找到特色服务列表上方的 **搜索市场** 文本框。

1.  在搜索文本框中，输入 **容器注册表**，然后按 **Enter** 键。

1.  在 **全部内容** 搜索结果边栏选项卡中，选择 **容器注册表** 结果。

1.  在 **容器注册表** 边栏选项卡中，选择 **创建**。

1.  在 **创建容器注册表** 边栏选项卡中，执行以下操作：

    1.  在 **注册表名称** 文本框中，为注册表提供全局唯一名称。

        >  注意： 边栏选项卡将自动检查名称的唯一性，并在需要选择其他名称时通知你。

    1.  将 **订阅** 文本框保留设置为默认值。

    1.  在 **资源组** 下拉列表中，选择现有的 **ContainerCompute** 选项。

    1.  在 **位置** 文本框中，选择 **美国东部**。

    1.  在 **管理员用户** 部分，选择 **禁用**。

    1.  在 **SKU** 下拉列表中，选择 **基本**。

    1.  选择 **创建**。

1.  等待创建任务完成后再继续本实验室。

#### 任务 4：打开 Cloud Shell 并存储Azure 容器注册表元数据

1.  在门户顶部，选择 **Cloud Shell** 图标打开一个新的 Shell 实例。

1.  等待 **Cloud Shell** 完成连接实例再继续本实验室。

1.  在门户底部的 **Cloud Shell** 命令提示符中，输入以下命令，然后按 Enter 键以查看订阅中的所有容器注册表列表：

```
az acr list
```

1.  输入以下命令并按 Enter 键：

```
az acr list --query "max_by([], &creationDate).name" --output tsv
```

1.  输入以下命令并按 Enter 键：

```
acrName=$(az acr list --query "max_by([], &creationDate).name" --output tsv)
```

1.  输入以下命令并按 Enter 键：

```
echo $acrName
```

#### 任务 5：将 Docker 容器映像部署到 Azure 容器注册表

1.  输入以下命令并按 Enter 键以将活动目录从 **\~/** 更改为 **\~/clouddrive/ipcheck**：

```
cd ~/clouddrive/ipcheck
```

1.  输入以下命令并按 Enter 键以查看当前目录的内容：

```
dir
```

1.  输入以下命令并按 Enter 键以将源代码上传到 **容器注册表** 并将容器映像构建为 **Azure 容器注册表任务**：

```
az acr build --registry $acrName --image ipcheck:latest .
```

1.  等待构建任务完成后再继续本实验室。

1.  关闭门户底部的 **Cloud Shell** 窗格。

#### 任务 6：在 Azure 容器注册表中验证容器映像

1.  在位于门户左侧的导航菜单上，选择 **资源组** 链接。

1.  在 **资源组** 边栏选项卡中，找到并选择你之前在本实验室中创建的 **ContainerCompute** 资源组。

1.  在 **ContainerCompute** 边栏选项卡中，选择你之前在本实验室中创建的容器注册表。

1.  在 **容器注册表** 边栏选项卡中，找到 **服务** 部分并选择 **存储库** 链接。

1.  在 **存储库** 部分，选择 **ipcheck** 容器映像存储库。

1.  在 **存储库** 边栏选项卡中，选择 **最新** 标记。

1.  观察具有 **最新** 标记的容器映像版本元数据。

    > **注**： 你也可以选择 **运行 ID** 超链接以查看有关构建任务的元数据。

#### 回顾

在本练习中，你创建了一个 .NET Core 控制台应用程序来显示计算机的当前 IP 地址。然后，你将 Dockerfile 文件添加到应用程序，以便将其转换为 Docker 容器映像。最后，你将容器映像部署到 Azure 容器注册表。

### 练习 4：部署 Azure 容器实例 

#### 任务 1：在 Azure 容器注册表中启用管理员用户

1.  在位于门户左侧的导航菜单上，选择 **资源组** 链接。

1.  在 **资源组** 边栏选项卡中，找到并选择你之前在本实验室中创建的 **ContainerCompute** 资源组。

1.  在 **ContainerCompute** 边栏选项卡中，选择你之前在本实验室中创建的容器注册表。

1.  在 **容器注册表** 边栏选项卡中，选择边栏选项卡顶部的 **更新**。

1.  在 **更新容器注册表** 边栏选项卡中，执行以下操作：
    
    1.  在 **管理员用户** 部分，选择 **启用**。
    
    1.  选择 **保存**。
    
1.  关闭 **更新容器注册表** 边栏选项卡。

#### 任务 2：自动将容器映像自动部署到 Azure 容器实例

1.  在 **容器注册表** 边栏选项卡中，找到 **服务** 部分并选择 **存储库** 链接。

1.  在 **存储库** 部分，选择 **ipcheck** 容器映像存储库。

1.  在 **存储库** 边栏选项卡中，选择紧靠 **最新** 标记条目右侧的省略号菜单。

1.  在显示的弹出菜单中，选择 **运行实例** 链接。

1.  在显示的 **创建容器实例** 边栏选项卡中，执行以下操作：
    
    1.  在 **容器名称** 文本框中，输入 **managedcompute**。
    
    1.  将 **容器映像** 文本框保留设置为默认值。
    
    1.  在 **操作系统类型** 部分，选择 **Linux**。
    
    1.  将 **订阅** 文本框保留设置为默认值。
    
    1.  在 **资源组** 拉列表中，选择 **ContainerCompute**。
    
    1.  在 **位置** 下拉列表中，选择 **美国东部**。
    
    1.  在 **核心数量** 下拉列表中，选择 **2**。
    
    1.  在 **内存 (GB)** 文本框中，输入 **4**。
    
    1.  在 **公共 IP 地址** 部分，选择 **否**。
    
    1. 选择 **确定**。

1.  等待创建任务完成后再继续本实验室。

#### 任务 3：手动将容器映像部署到 Azure 容器实例

1.  在位于门户左侧的导航菜单上，选择 **资源组** 链接。

1.  在 **资源组** 边栏选项卡中，找到并选择你之前在本实验室中创建的 **ContainerCompute** 资源组。

1.  在 **ContainerCompute** 边栏选项卡中，选择你之前在本实验室中创建的容器注册表。

1.  在 **容器注册表** 边栏选项卡中，找到 **服务** 部分并选择 **访问密钥** 链接。

1.  在 **访问密钥** 部分，记录以下字段的值：
    
    1.  **登录服务器**
    
    1.  **用户名**
    
    1.  **密码**

        >**注**： 在创建另一个 **容器实例** 时，你之后会用到本实验室中的这些值。

1.  在位于门户左侧的导航菜单上，选择 **+ 创建资源** 链接。

1.  在顶部的 **新建** 边栏选项卡，找到特色服务列表上方的 **搜索市场** 文本框。

1.  在搜索文本框中，输入 **容器实例**，然后按 Enter 键。

1.  在 **全部内容** 搜索结果边栏选项卡中，选择 **容器实例** 结果。

1. 在 **容器实例** 边栏选项卡中，选择 **创建**。

1. 在 **创建容器实例** 边栏选项卡中，观察边栏选项卡左侧的选项卡，如 **基本** 和 **高级**。

    > **注**： 每个选项卡代表工作流中创建新 **容器实例** 的一个步骤。

1. 在 **基本** 选项卡中，执行以下操作：

    1. 将 **订阅** 文本框保留设置为默认值。

    1. 在 **资源组** 拉列表中，选择 **ContainerCompute**。
    
    1.  在 **容器名称** 文本框中，输入 **manualcompute**。

    1. 在 **区域** 下拉列表中，选择 **（美国）美国东部**。
    
    1.  在 **映像类型** 部分，选择 **专用**。
    
    1.  在 **映像名称** 文本框中，输入之前记录的 **登录服务器** 值，然后添加后缀 /**ipcheck:latest**。

        >**注**： 例如，如果 **登录服务器** 值为 **azadmin.azurecr.io**，则容器映像名称为  **azadmin.azurecr.io/ipcheck:latest**

    1.  在 **映像注册表登录服务器** 文本框中，输入之前在本实验室中记录的 **登录服务器** 值。

    1.  在 **映像注册表用户名** 文本框中，输入之前在本实验室中记录的 **用户名** 值。

    1.  在 **映像注册表密码** 文本框中，输入之前在本实验室中记录的 **密码** 值。

    1. 在 **操作系统类型** 部分，选择 **Linux**。

    1. 在 **大小** 部分，选择 **更改大小** 链接。

    1. 在 **更改容器大小** 边栏选项卡中，执行以下操作：

        1. 在 **CPU 核心数** 文本框中，输入 **1**。

        1. 在 **内存 (GiB)** 文本框中，输入 **1.5**。

        1. 保留 **GPU 类型** 下拉列表的默认值。

        1. 选择 **确定**。
    
    1. 选择 **下一步： 网络**

1. 在 **网络** 选项卡中，执行以下操作：
    
    1. 在 **包括公共 IP 地址** 部分，选择 **是**。

    1. 确保在 **端口** 部分，存在端口 **80** 和端口协议 **TCP**。
    
    1. 将 **DNS 名称标签** 文本框留空。

    1. 选择 **下一步： 高级**。

1. 在 **高级** 选项卡中，执行以下操作：
    
    1. 在 **重启策略** 下拉列表中，选择 **失败时**。
    
    1. 将 **环境变量** 文本框留空。
    
    1. 将 **命令替代** 文本框留空。

    1. 选择 **查看 + 创建**。

1. 在 **查看 + 创建** 选项卡中，查看选定的选项。

1. 选择 **创建** 以使用指定配置创建容器实例。

1. 等待创建任务完成后再继续本实验室。

#### 任务 4：验证容器实例是否成功运行

1.  在位于门户左侧的导航菜单上，选择 **资源组** 链接。

1.  在 **资源组** 边栏选项卡中，找到并选择你之前在本实验室中创建的  **ContainerCompute** 资源组。

1.  在 **ContainerCompute** 边栏选项卡中，选择你之前在本实验室中创建的 **manualcompute** 容器实例。

1.  在 **容器实例** 边栏选项卡中，找到 **服务** 部分并选择 **设置** 链接。

1.  在 **容器** 部分，查看 **事件** 列表。

1.  选择 **日志** 选项卡并观察容器实例中的文本日志。
> **注**： 你也可以选择查看 **managedcompute** 容器实例中的 **事件** 和 **日志**。

> **注**： 应用程序完成执行后，容器因为已完成工作而终止。  对于手动创建的容器实例，你已设置允许终止容器，因此该容器仅显示运行一次执行。自动创建的实例没有提供此选项，并且默认该容器应始终处于运行状态，因此该容器会反复重启。

#### 回顾

在本练习中，你使用了多种方法将容器映像部署到 Azure 容器实例。通过使用手动方法，你还可以进一步自定义部署并执行基于任务的应用程序作为容器运行的一部分。

### 练习 5：清理订阅 

#### 任务 1：打开 Cloud Shell 并列出资源组

1.  在门户顶部，选择 **Cloud Shell** 图标打开一个新的 Shell 实例。

1.  在门户底部的 **Cloud Shell** 命令提示符中，输入以下命令，然后按 Enter 键列出订阅中的所有资源组：

```
az group list
```

1.  输入以下命令，然后按 Enter 键查看删除资源组的可能命令列表：

```
az group delete --help
```

#### 任务 2：删除资源组

1.  输入以下命令，然后按 Enter 键删除 **ContainerCompute** 资源组：

```
az group delete --name ContainerCompute --no-wait --yes
```

1.  关闭门户底部的 **Cloud Shell** 窗格。

#### 任务 3：关闭活动应用程序

1.  关闭当前正在运行的 **Microsoft Edge** 应用程序。

#### 回顾

在本练习中，你通过移除本实验室中使用过的 **资源组** 来清理订阅。
